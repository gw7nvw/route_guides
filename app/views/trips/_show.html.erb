<% provide(:title, "Trip | "+@trip.id.to_s) %>
<% @title=" | Trip | "+@trip.id.to_s %>
<script> 
   update_title('<%=@title%>'); 
   document.getElementById("page_status").innerHTML = '';
</script>
<% @trip.trip_details.each do |td| %>
============================================================================<br/>
  <% 
      #convert show boolean to int
      @showForward=if(td.showForward) then 1 else 0 end
      @showReverse=if(td.showReverse) then 1 else 0 end
      @showConditions=if(td.showConditions) then 1 else 0 end
      @showLinks=if(td.showLinks) then 1 else 0 end
  %>

  <% if td.place %>
    <% @place=td.place %>
    <%     
       wgs84_proj4 = '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs'
       nztm_proj4 = '+proj=tmerc +lat_0=0 +lon_0=173 +k=0.9996 +x_0=1600000 +y_0=10000000 +ellps=GRS80 +towg'

       wgs=RGeo::CoordSys::Proj4.new(wgs84_proj4)
       nztm=RGeo::CoordSys::Proj4.new(nztm_proj4)
   
       xyarr=RGeo::CoordSys::Proj4::transform_coords(wgs,nztm,@place.location.x, @place.location.y)
   
       #convery location to readable format
       @x=xyarr[0]
       @y=xyarr[1]      


    %>
    <%= render 'places/place_details' %>
  <% end %>
  <% if td.route %>
    <% if td.route_id >0 %>
    <% @route=td.route %>
    <%= render 'routes/route_details' %>
    <% end %>
  <% end %>
<% end %>

